<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="Learn poker rules and strategies through interactive gameplay.">
<meta name="keywords" content="poker, educational, card game">
<title>Educational Poker</title>
<style>
    body {
        font-family: sans-serif;
        background: #0b3d0b;
        color: white;
        text-align: center;
        padding: 10px;
    }
    .table {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }
    .card {
        width: 60px;
        height: 90px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        background: white;
        color: black;
        box-shadow: 0 0 5px #000;
        cursor: pointer;
        transition: transform 0.2s;
    }
    .card.highlight {
        background: gold;
        transform: scale(1.1);
    }
    #log {
        background: rgba(0,0,0,0.5);
        padding: 10px;
        margin-top: 20px;
        border-radius: 5px;
        text-align: left;
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
        font-size: 14px;
    }
    button {
        padding: 8px 16px;
        margin-top: 15px;
        cursor: pointer;
    }
</style>
</head>
<body>

<h1>🎯 Educational Poker</h1>

<div id="player-hand" class="table"></div>
<div id="cpu-hand" class="table" style="display:none;"></div>

<button id="dealBtn">Deal Cards</button>
<div id="log"></div>

<script>
const suits = ["♠","♥","♦","♣"];
const ranks = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];

let deck = [], playerHand = [], cpuHand = [];
let stage = 0; // 0: deal, 1: change cards, 2: showdown

function createDeck() {
    deck = [];
    for (let s of suits) {
        for (let r of ranks) {
            deck.push({rank: r, suit: s});
        }
    }
}

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function renderHand(hand, containerId, clickable=false) {
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    hand.forEach((card, index) => {
        const div = document.createElement("div");
        div.className = "card";
        div.textContent = card.rank + card.suit;
        if (clickable) {
            div.onclick = () => {
                div.classList.toggle("highlight");
            }
        }
        container.appendChild(div);
    });
}

function logMessage(msg) {
    document.getElementById("log").innerHTML += `<div>• ${msg}</div>`;
}

function dealCards() {
    createDeck();
    shuffle(deck);
    playerHand = deck.splice(0,5);
    cpuHand = deck.splice(0,5);
    renderHand(playerHand, "player-hand", true);
    stage = 1;
    document.getElementById("cpu-hand").style.display = "none";
    document.getElementById("log").innerHTML = "";
    logMessage("Cards dealt. Select cards to change.");
    document.getElementById("dealBtn").textContent = "Confirm Changes";
}

function confirmChanges() {
    const selectedIndexes = [];
    document.querySelectorAll("#player-hand .card").forEach((c,i) => {
        if (c.classList.contains("highlight")) selectedIndexes.push(i);
    });
    selectedIndexes.forEach(i => {
        playerHand[i] = deck.shift();
    });
    logMessage(`You changed ${selectedIndexes.length} card(s).`);
    cpuLogic();
    stage = 2;
    showdown();
}

function cpuLogic() {
    // Example: CPU changes random 0-2 cards
    const changes = Math.floor(Math.random()*3);
    for (let i = 0; i < changes; i++) {
        cpuHand[i] = deck.shift();
    }
    logMessage(`CPU changed ${changes} card(s) strategically.`);
}

function handValue(hand) {
    // simple scoring: count ranks
    let counts = {};
    hand.forEach(c => counts[c.rank] = (counts[c.rank]||0) + 1);
    let values = Object.values(counts).sort((a,b)=>b-a);
    if (values[0] === 4) return {score:7, name:"Four of a Kind"};
    if (values[0] === 3 && values[1] === 2) return {score:6, name:"Full House"};
    if (values[0] === 3) return {score:3, name:"Three of a Kind"};
    if (values[0] === 2 && values[1] === 2) return {score:2, name:"Two Pairs"};
    if (values[0] === 2) return {score:1, name:"One Pair"};
    return {score:0, name:"High Card"};
}

function showdown() {
    renderHand(cpuHand, "cpu-hand");
    document.getElementById("cpu-hand").style.display = "flex";
    const playerVal = handValue(playerHand);
    const cpuVal = handValue(cpuHand);
    logMessage(`Your hand: ${playerVal.name}`);
    logMessage(`CPU hand: ${cpuVal.name}`);
    if (playerVal.score > cpuVal.score) {
        logMessage(`✅ You win with ${playerVal.name}!`);
        highlightWinningCards(playerHand, playerVal);
        suggestBetterMoves();
    } else if (playerVal.score < cpuVal.score) {
        logMessage(`❌ CPU wins with ${cpuVal.name}.`);
        highlightWinningCards(cpuHand, cpuVal);
        suggestBetterMoves();
    } else {
        logMessage(`🤝 It's a tie!`);
    }
    document.getElementById("dealBtn").textContent = "Deal Again";
    stage = 0;
}

function highlightWinningCards(hand, val) {
    const container = document.getElementById(
        hand === playerHand ? "player-hand" : "cpu-hand"
    );
    container.querySelectorAll(".card").forEach(c => {
        c.classList.remove("highlight");
    });
    if (val.score > 0) {
        let mainRank = getMainRank(hand);
        container.querySelectorAll(".card").forEach((c,i) => {
            if (hand[i].rank === mainRank) c.classList.add("highlight");
        });
    }
}

function getMainRank(hand) {
    let counts = {};
    hand.forEach(c => counts[c.rank] = (counts[c.rank]||0) + 1);
    return Object.entries(counts).sort((a,b)=>b[1]-a[1])[0][0];
}

function suggestBetterMoves() {
    // very basic hint system
    logMessage("💡 Analysis: If you had kept high pairs or consecutive cards, you might have improved your chance.");
    // Here could be extended with exact alternative winning paths
}

document.getElementById("dealBtn").onclick = () => {
    if (stage === 0) dealCards();
    else if (stage === 1) confirmChanges();
};
</script>

</body>
</html>
